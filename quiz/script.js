const ezQuestions = {
  watch: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/watch--_gb_1.mp3',
  jeans: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/jeans--_gb_1.mp3',
  skirt: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/skirt--_gb_1.mp3',
  hour: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/hour--_gb_1.mp3',
  passport: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/passport--_gb_1.mp3',
  relax: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/relax--_gb_1.mp3',
  sweep: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/sweep--_gb_1.mp3',
  children: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/children--_gb_1.mp3',
  yard: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/yard--_gb_1.mp3',
  dress: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/dress--_gb_1.mp3',
  design: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/design--_gb_1.mp3',
  adventure: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/adventure--_gb_1.mp3',
  ticket: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/ticket--_gb_1.mp3',
  dolphin: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/dolphin--_gb_1.mp3',
  autograph: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/autograph--_gb_1.mp3',
  persuaded: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/persuaded--_gb_1.mp3',
  appointment: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/appointment--_gb_1.mp3',
  question: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/question--_gb_1.mp3',
  language: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/language--_gb_1.mp3',
  burning: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/burning--_gb_1.mp3',
}

const ezHint = {
  watch: 'look at or observe attentively over a period of time.',
  jeans: 'hard-wearing trousers made of denim or other cotton fabric, for informal wear.',
  skirt: 'a garment fastened around the waist and hanging down around the legs, worn by women and girls.',
  hour: 'a period of time equal to a twenty-fourth part of a day and night and divided into 60 minutes.',
  passport: 'an official document issued by a government, certifying the holder\'s identity and citizenship.',
  relax: 'make or become less tense or anxious.',
  sweep: 'clean (an area) by brushing away dirt or litter.',
  children: 'a young human being below the age of puberty or below the legal age.',
  yard: 'a unit of linear measure equal to 3 feet',
  dress: 'decorate (something) in an artistic or attractive way.',
  design: 'a plan or drawing produced to show the look and function or workings.',
  adventure: 'an unusual and exciting, typically hazardous, experience or activity.',
  ticket: 'a certificate or warrant.',
  dolphin: 'a small gregarious toothed whale that typically has a beaklike snout and a curved fin on the back.',
  autograph: 'a signature, especially that of a celebrity written as a memento for an admirer.',
  persuaded: 'cause (someone) to do something through reasoning or argument.',
  appointment: 'an arrangement to meet someone at a particular time and place.',
  question: 'a sentence worded or expressed so as to elicit information.',
  language: 'a system of communication used by a particular country or community.',
  burning: 'very hot or bright.'
}

const medQuestions = {
  courtesy: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/courtesy--_gb_1.mp3',
  influence: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/influence--_gb_1.mp3',
  exhibit: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/exhibit--_gb_1.mp3',
  chrysanthemum: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/chrysanthemum--_gb_1.mp3',
  bureau: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/bureau--_gb_1.mp3',
  havoc: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/havoc--_gb_1.mp3',
  foreknowledge: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/foreknowledge--_gb_1.mp3',
  scrimmage: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/scrimmage--_gb_1.mp3',
  polytheism: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/polytheism--_gb_1.mp3',
  decathlon: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/decathlon--_gb_1.mp3',
  parallel: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/parallel--_gb_1.mp3',
  exercise: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/exercise--_gb_1.mp3',
  slippery: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/slippery--_gb_1.mp3',
  muffin: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/muffin--_gb_1.mp3',
  management: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/management--_gb_1.mp3',
  scenery: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/scenery--_gb_1.mp3',
  slumber: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/slumber--_gb_1.mp3',
  spacious: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/spacious--_gb_1.mp3',
  unknown: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/unknown--_gb_1.mp3',
  guarantee: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/guarantee--_gb_1.mp3'
}

const medHint = {
  courtesy : 'a polite speech or action, especially one required by convention.',
  influence : 'the power to have an important effect on someone or something',
  exhibit : 'something presented formally and in a public setting',
  chrysanthemum : 'any of numerous perennial Old World herbs having showy brightly colored flower heads of the genera',
  bureau : 'an administrative unit of government',
  havoc : 'violent and needless disturbance',
  foreknowledge : 'knowledge of an event before it occurs',
  scrimmage : '(American football) practice play between a football team\'s squads',
  polytheism : 'belief in multiple gods',
  decathlon : 'an athletic contest consisting of ten different events',
  parallel : 'parallel means two lines that never intersect think of an equal sign',
  exercise : 'physical activity, like an exercise class, or the act of practicing anything',
  slippery : 'causing or tending to cause things to slip or slide',
  muffin : 'a sweet quick bread baked in a cup-shaped pan',
  management : 'the act of directing or controlling things',
  scenery : 'a word for how a place looks, especially a beautiful, outdoorsy place',
  slumber : 'be asleep',
  spacious : '(of buildings and rooms) having ample space',
  unknown : 'not known',
  guarantee : 'an unconditional commitment that something will happen or that something is true',
}

const hardQuestions = {
  espionge: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/espionge--_gb_1.mp3',
  hazardous: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/hazardous--_gb_1.mp3',
  facsimile: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/facsimile--_gb_1.mp3',
  magnanimous: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/magnanimous--_gb_1.mp3',
  nonchalance: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/nonchalance--_gb_1.mp3',
  onomatopoeia: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/onomatopoeia--_gb_1.mp3',
  pandemonium: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/pandemonium--_gb_1.mp3',
  philanthropist: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/philanthropist--_gb_1.mp3',
  feasibility: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/feasibility--_gb_1.mp3',
  handkerchief: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/handkerchief--_gb_1.mp3',
  incandescent: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/incandescent--_gb_1.mp3',
  blasphemous: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/blasphemous--_gb_1.mp3',
  expediency: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/expediency--_gb_1.mp3',
  irreconcilable: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/irreconcilable--_gb_1.mp3',
  nausea: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/nausea--_gb_1.mp3',
  notoriety: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/notoriety--_gb_1.mp3',
  omnipotent: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/omnipotent--_gb_1.mp3',
  patriarch: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/patriarch--_gb_1.mp3',
  idiosyncrasy: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/idiosyncrasy--_gb_1.mp3',
  fallacy: 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/fallacy--_gb_1.mp3'
}

const hardHint = {
  espionage :  'the systematic use of spies to get military or political secrets',
  hazardous : 'involving risk or danger',
  facsimile :  'a copy or reproduction of something',
  magnanimous : 'person has a generous spirit',
  nonchalance :  'a casual lack of concern, a relaxed state without anxiety or enthusiasm',
  onomatopoeia : 'using words that imitate the sound they denote',
  pandemonium : 'a state of extreme confusion and disorder',
  philanthropist : 'a person who gives money or gifts to charities, or helps needy people in other ways',
  feasibility : 'the quality of being doable',
  handkerchief : 'a square piece of cloth used for wiping the eyes or nose or as a costume accessory',
  incandescent: 'emitting light as a result of being heated.',
  blasphemous: 'sacrilegious against God or sacred things; profane.',
  expediency: 'the quality of being convenient and practical despite possibly being improper.',
  irreconcilable: 'any of two or more ideas, facts, or statements that cannot be made compatible.',
  nausea: 'a feeling of sickness with an inclination to vomit.',
  notoriety: 'the state of being famous or well known for some bad quality or deed.',
  omnipotent: 'having unlimited power; able to do anything.',
  patriarch: 'the male head of a family or tribe.',
  idiosyncrasy: 'a mode of behaviour or way of thought peculiar to an individual.',
  fallacy:  'mistaken belief, especially one based on unsound argument.'
}

// Initializing element
const wrapper = document.getElementById('wrapper')
const main = document.getElementById('main')
const prevScore = document.getElementById('previousScore')
const quiz = document.getElementById('quiz')
const difficulty = document.getElementById('difficulty')
const audioSource = document.getElementById('audioSource')
const input = document.getElementById('answers')
const hintWrapper = document.getElementById('hintWrapper')
const hintBtn = document.getElementById('hint')
const hint = document.getElementById('showHint')
const scoreInfo = document.getElementById('scoreInfo')
const Alert = document.getElementById('alert')
const ezScore = document.getElementById('ezScore')
const medScore = document.getElementById('medScore')
const hardScore = document.getElementById('hardScore')
let isLookAtHint = false

// init variable
const { values, keys } = Object
let audio
let currentQuestion = ''
let answers = ''
let diff = ''
let page = 1
let score = 0
const answered = []

// for the begining
wrapper.removeChild(main)
ezScore.innerText = localStorage.getItem('ezScore') ? localStorage.getItem('ezScore') : 'None'
medScore.innerText = localStorage.getItem('medScore') ? localStorage.getItem('medScore') : 'None'
hardScore.innerText = localStorage.getItem('hardScore') ? localStorage.getItem('hardScore') : 'None'

// For timer
let time = 5 // You can change the time here
let timeInMinutes = time * 60
let interval = null

/**
 * To start the timer
 */
const startTimer = () => {
  const timer = document.getElementById('timer')

  const minutes = Math.floor(timeInMinutes / 60)
  let seconds = timeInMinutes % 60

  timeInMinutes--
  timer.innerText = `${minutes < 10 ? '0'+minutes : minutes}:${seconds < 10 ? '0'+seconds : seconds}`

  if (timeInMinutes < 0) {
    finishQuiz()
    clearInterval(interval)
  }
}

/**
 * Handling easy button click
 */
const handleEasyBtn = () => {
  prevScore.classList.add("previousScoreMobile")
  wrapper.removeChild(difficulty)
  wrapper.append(main)
  diff = 'easy'

  runQuiz()
  interval = setInterval(startTimer, 1000)
}

/**
 * Handling medium button click
 */
 const handleMedBtn = () => {
  prevScore.classList.add("previousScoreMobile")
  wrapper.removeChild(difficulty)
  wrapper.append(main)
  diff = 'medium'

  runQuiz()
  interval = setInterval(startTimer, 1000)
}

/**
 * Handling hard button click
 */
 const handleHardBtn = () => {
  prevScore.classList.add("previousScoreMobile")
  wrapper.removeChild(difficulty)
  wrapper.append(main)
  diff = 'hard'

  runQuiz()
  interval = setInterval(startTimer, 1000)
}

/**
 * Handling show hint
 */
const showHint = () => {
  isLookAtHint = true
  hintWrapper.removeChild(hintBtn)
  switch(diff) {
    case 'easy':
      hint.innerHTML = `<b>Hint:</b> ${ezHint[currentQuestion]}`
      break
    case 'medium':
      hint.innerHTML = `<b>Hint:</b> ${medHint[currentQuestion]}`
      break
    case 'hard':
      hint.innerHTML = `<b>Hint:</b> ${hardHint[currentQuestion]}`
      break
  }
}

/**
 * Running quiz
 */
const runQuiz = () => {
  const question = getDifficultyQuestion(diff)
  scoreInfo.innerText = `Your score: ${score}`
  switch(diff) {
    case 'easy':
      currentQuestion = keys(ezQuestions)[question]
      break
    case 'medium':
      currentQuestion = keys(medQuestions)[question]
      break
    case 'hard':
      currentQuestion = keys(hardQuestions)[question]
      break
  }
}

const random = () => {
  return Math.floor(Math.random() * keys(ezQuestions).length)
}
/**
 * Handling get question by difficulty
 * @returns {number}
 */
const getDifficultyQuestion = () => {
  let idx = random()

  // Filtering is the current question has passed yet
  const filterQuestion = answered.find(index => index === idx)
  if (page > 1 && filterQuestion !== undefined) {
    idx = random()
  }
  answered.push(idx)

  switch(diff) {
    case 'easy':
      audio = new Audio(values(ezQuestions)[idx])
      break
    case 'medium':
      audio = new Audio(values(medQuestions)[idx])
      break
    case 'hard':
      audio = new Audio(values(hardQuestions)[idx])
      break
  }

  return idx
}

/**
 * Handle play audio
 */
const playAudio = () => {
  audio.play()
}

/**
 * To handle on change
 * @param {Event} e
 */
const handleChange = (e) => {
  answers = e.target.value
}

/**
 * To call alert
 * @param {boolean} isCorrect
 * @returns
 */
const callAlert = (isCorrect = true, isFinished = false) => {
  let alertAudio = isCorrect
    ? new Audio('https://www.myinstants.com/media/sounds/correct_uQ7Arvh.mp3')
    : new Audio('https://www.myinstants.com/media/sounds/spongebob-disappointed-sound-effect.mp3')

  setTimeout(() => {
    Alert.setAttribute('class', 'alert animateOut')
    Alert.innerHTML = ''
  }, 3800)
  Alert.setAttribute('class', 'alert animateIn')

  if (isFinished) {
    new Audio('https://www.myinstants.com/media/sounds/kids_cheering.mp3').play()
    Alert.setAttribute('style', 'background-color: #21BF73;')
    Alert.innerHTML =
    `<div>
      <svg xmlns="http://www.w3.org/2000/svg" style="height: 35px;" fill="none" viewBox="0 0 24 24" stroke="white">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h3>You have finished the quiz!</h3>
    </div>
    <p>Good job! Your score was ${score}! Thank you for playing!</p>`

    return
  }

  alertAudio.play()

  if (isCorrect) {
    Alert.setAttribute('style', 'background-color: #21BF73;')
    Alert.innerHTML =
    `<div>
      <svg xmlns="http://www.w3.org/2000/svg" style="height: 35px;" fill="none" viewBox="0 0 24 24" stroke="white">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h3>You are correct!</h3>
    </div>
    <p>Keep up the good work!</p>`
  } else {
    Alert.setAttribute('style', 'background-color: #ff0000;')
    Alert.innerHTML =
    `<div>
      <svg xmlns="http://www.w3.org/2000/svg" style="height: 35px;" fill="none" viewBox="0 0 24 24" stroke="white">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h3>You are wrong!</h3>
    </div>
    <p>Nice try! You can try again</p>`
  }
}

const loading = () => {
  setTimeout(() => {
    main.removeAttribute('class')
    main.innerHTML = ''
    main.appendChild(quiz)
    runQuiz()
  }, 3500)

  main.setAttribute('class', 'loading')
  main.removeChild(quiz)
  main.innerHTML = `
  <svg xmlns="http://www.w3.org/2000/svg" style='height: 50px;' class='spin' viewBox="0 0 20 20" fill="currentColor">
    <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
  </svg>
  <p style="margin-left: 10px;">Getting next question... please Wait</p>`
}

/**
 * Finishing quiz
 */
const finishQuiz = () => {
  setTimeout(() => {
    location.reload()
  }, 3900)
  callAlert(null, true)

  switch(diff) { // Insert the score to local storage
    case 'easy':
      localStorage.setItem('ezScore', score)
      break
    case 'medium':
      localStorage.setItem('medScore', score)
      break
    case 'hard':
      localStorage.setItem('hardScore', score)
      break
  }
}

/**
 * Handling submit
 * @param {Event} e
 */
const handleSubmit = (e) => {
  e.preventDefault()
  if (page <= 10) {
    if (answers.toLowerCase() === currentQuestion.toLowerCase()) {
      callAlert(isCorrect = true)
      score += 10
    } else {
      callAlert(isCorrect = false)
    }

    input.value = ''

    if (isLookAtHint) { // If user took a look at hint
      hintWrapper.removeChild(hint)
      hintWrapper.append(hintBtn)
      isLookAtHint = false
    }

    page++
    loading()
    return
  }

  finishQuiz()
}